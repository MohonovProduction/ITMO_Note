"use strict";(self["webpackChunkdesign_notes"]=self["webpackChunkdesign_notes"]||[]).push([[889],{889:function(e,t,o){o.r(t),o.d(t,{default:function(){return U}});var n=o(641),a=o(33);const s={class:"notes-list"},i={class:"header-container"},r={class:"controls"},l={key:1,class:"error-message"},c={key:2,class:"categories-list"},d={key:3,class:"empty-state"};function g(e,t,o,g,u,h){const p=(0,n.g2)("Banner"),C=(0,n.g2)("BaseButton"),y=(0,n.g2)("CategoryFilter"),m=(0,n.g2)("CategoryCard");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.bF)(p),(0,n.Lk)("div",i,[t[0]||(t[0]=(0,n.Lk)("h1",null,"Список конспектов",-1)),(0,n.Lk)("div",r,[(0,n.bF)(C,{onClick:h.expandAll,icon:"expand_more",iconOnly:""},null,8,["onClick"]),(0,n.bF)(C,{onClick:h.collapseAll,icon:"expand_less",iconOnly:""},null,8,["onClick"]),(0,n.bF)(C,{onClick:h.refreshNotes,icon:"refresh",loading:e.loading,iconOnly:""},null,8,["onClick","loading"])])]),e.categories.length?((0,n.uX)(),(0,n.Wv)(y,{key:0,onCategoryChange:h.handleCategorySelect},null,8,["onCategoryChange"])):(0,n.Q3)("",!0),e.error?((0,n.uX)(),(0,n.CE)("div",l," Ошибка загрузки данных: "+(0,a.v_)(e.error),1)):(0,n.Q3)("",!0),e.loading||e.error?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",c,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(h.groupedNotes,((e,t)=>((0,n.uX)(),(0,n.Wv)(m,{key:e.name,category:e,"is-open":h.isCategoryOpen(t),onToggle:e=>h.toggleCategory(t),onNoteClick:h.handleNoteClick},null,8,["category","is-open","onToggle","onNoteClick"])))),128))])),e.loading||h.groupedNotes.length?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",d,[t[2]||(t[2]=(0,n.eW)(" Нет доступных конспектов ")),(0,n.bF)(C,{onClick:h.refreshNotes,icon:"refresh"},{default:(0,n.k6)((()=>t[1]||(t[1]=[(0,n.eW)("Попробовать снова")]))),_:1},8,["onClick"])]))])}var u=o(278),h=o(818);const p={class:"category-card"},C={class:"header-right"},y={class:"note-count"},m={class:"notes-grid"};function f(e,t,o,s,i,r){const l=(0,n.g2)("NoteCard");return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",{class:"category-header",onClick:t[0]||(t[0]=t=>e.$emit("toggle"))},[(0,n.Lk)("h2",null,(0,a.v_)(o.category.name||"Без категории"),1),(0,n.Lk)("div",C,[(0,n.Lk)("span",y,(0,a.v_)(o.category.notes.length),1),(0,n.Lk)("span",{class:(0,a.C4)(["material-symbols-outlined toggle-icon",{"is-open":o.isOpen}])},"expand_more",2)])]),(0,n.Lk)("div",{style:(0,a.Tr)([{height:s.contentHeight},{transition:"height var(--transition-normal)"}]),ref:"contentRef"},[(0,n.Lk)("div",m,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.category.notes,(t=>((0,n.uX)(),(0,n.Wv)(l,{key:t.id,note:t,onClick:o=>e.$emit("note-click",t)},null,8,["note","onClick"])))),128))])],4)])}var v=o(751);const k={class:"note-header"},b={class:"description"},_={class:"meta"},N={class:"date"},L={class:"category-badge"};function A(e,t,o,s,i,r){const l=(0,n.g2)("BaseButton");return(0,n.uX)(),(0,n.CE)("div",{class:"note-card",onClick:t[0]||(t[0]=t=>e.$emit("click"))},[(0,n.Lk)("div",k,[(0,n.Lk)("h3",null,(0,a.v_)(o.note.title),1),(0,n.bF)(l,{variant:"secondary",size:"small",onClick:(0,v.D$)(r.handleDelete,["stop"]),disabled:i.isDeleting,icon:"delete",iconOnly:""},null,8,["onClick","disabled"])]),(0,n.Lk)("p",b,(0,a.v_)(o.note.description),1),(0,n.Lk)("div",_,[(0,n.Lk)("span",N,(0,a.v_)(r.formatDate(o.note.date)),1),(0,n.Lk)("span",L,(0,a.v_)(o.note.category),1)])])}var O={name:"NoteCard",components:{BaseButton:h.A},props:{note:{type:Object,required:!0}},data(){return{isDeleting:!1}},methods:{...(0,u.i0)("notes",["deleteNote"]),...(0,u.i0)("ui",["addNotification","openAuthModal"]),formatDate(e){return new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})},async handleDelete(){if(!this.isDeleting)try{this.isDeleting=!0,await this.deleteNote(this.note.id),this.addNotification({message:"Заметка успешно удалена",type:"success"})}catch(e){401===e.response?.status?(this.openAuthModal(),this.addNotification({message:"Для удаления заметки необходимо авторизоваться",type:"error"})):this.addNotification({message:"Ошибка при удалении заметки",type:"error"})}finally{this.isDeleting=!1}}}},F=o(262);const B=(0,F.A)(O,[["render",A],["__scopeId","data-v-048ea722"]]);var D=B,X=o(953),w={name:"CategoryCard",components:{NoteCard:D},props:{category:{type:Object,required:!0},isOpen:{type:Boolean,default:!1}},setup(e){const t=(0,X.KR)(null),o=(0,n.EW)((()=>e.isOpen?t.value?`${t.value.scrollHeight}px`:"auto":"0px"));return{contentRef:t,contentHeight:o}}};const E=(0,F.A)(w,[["render",f],["__scopeId","data-v-1e82ba95"]]);var x=E;const I={class:"category-filter"};function $(e,t,o,a,s,i){const r=(0,n.g2)("SelectField");return(0,n.uX)(),(0,n.CE)("div",I,[(0,n.bF)(r,{id:"category-filter",label:"Категория",modelValue:s.selectedCategory,"onUpdate:modelValue":[t[0]||(t[0]=e=>s.selectedCategory=e),i.handleCategoryChange],options:i.categoryOptions,placeholder:"Все категории"},null,8,["modelValue","options","onUpdate:modelValue"])])}var S=o(682),W={name:"CategoryFilter",components:{SelectField:S.A},data(){return{selectedCategory:""}},computed:{...(0,u.L8)("notes",["categories"]),categoryOptions(){return[{value:"",label:"Все категории"},...this.categories.map((e=>({value:e.name,label:e.name})))]}},methods:{handleCategoryChange(){this.$emit("category-change",this.selectedCategory)}}};const H=(0,F.A)(W,[["render",$],["__scopeId","data-v-31b68a56"]]);var P=H;const V={class:"info-banner"};function M(e,t,o,a,s,i){return(0,n.uX)(),(0,n.CE)("section",V,t[0]||(t[0]=[(0,n.Fv)('<div class="info-banner__content"><h1 class="info-banner__title">Третья неделя без работающего бэка!</h1><div class="info-banner__author"><span class="material-symbols-outlined info-banner__icon">person</span><span>Михаил Мохонов, фронт</span></div><p class="info-banner__text"> Можете писать issues <a href="https://github.com/Tor4narek/ItmoNoteApi/issues" class="info-banner__link">сюда</a>, пусть он апупеет </p><div class="info-banner__social"><a href="https://t.me/mohonovproduction" class="info-banner__social-link" target="_blank" rel="noopener noreferrer"><i class="fab fa-telegram"></i></a><a href="https://github.com/mohonovproduction" class="info-banner__social-link" target="_blank" rel="noopener noreferrer"><i class="fab fa-github"></i></a></div></div>',1)]))}var Q={name:"Banner"};const R=(0,F.A)(Q,[["render",M]]);var T=R,q={name:"HomeView",components:{BaseButton:h.A,CategoryCard:x,CategoryFilter:P,Banner:T},data(){return{openCategories:[],isAuthModalOpen:!1}},computed:{...(0,u.aH)("notes",["error","loading"]),...(0,u.L8)("notes",["publicNotes","categories"]),...(0,u.L8)("auth",["isAuthenticated"]),groupedNotes(){const e={},t=[];return this.publicNotes.forEach((o=>{const n=o.category||"Без категории";e[n]||(e[n]=[],t.push(n)),e[n].push(o)})),t.map((t=>({name:t,notes:e[t].sort(((e,t)=>new Date(t.date)-new Date(e.date)))})))}},methods:{...(0,u.i0)("notes",["fetchPublicNotes","searchNotesByCategory","fetchCategories"]),async refreshNotes(){try{await this.fetchPublicNotes(),this.groupedNotes.length>0&&0===this.openCategories.length&&(this.openCategories=[0])}catch(e){console.error("Ошибка обновления:",e)}},toggleCategory(e){this.isCategoryOpen(e)?this.openCategories=this.openCategories.filter((t=>t!==e)):this.openCategories.push(e)},isCategoryOpen(e){return this.openCategories.includes(e)},expandAll(){this.openCategories=this.groupedNotes.map(((e,t)=>t))},collapseAll(){this.openCategories=[]},handleNoteClick(e){this.$router.push({name:"note",params:{id:e.id}})},async handleCategorySelect(e){e?await this.searchNotesByCategory(e):await this.fetchPublicNotes()},handleAuthSuccess(){this.isAuthModalOpen=!1}},async created(){await Promise.all([this.fetchPublicNotes(),this.fetchCategories()])},watch:{"$route.query.category"(e){if(e){const t=this.groupedNotes.findIndex((t=>t.name===e));t>=0&&(this.openCategories=[t])}}}};const K=(0,F.A)(q,[["render",g],["__scopeId","data-v-547a34ee"]]);var U=K}}]);
//# sourceMappingURL=889.f606c6d6.js.map